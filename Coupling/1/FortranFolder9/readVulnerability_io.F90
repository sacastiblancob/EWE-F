!========================================================================
! This file is part of EwE-F
! Copyright (C) 2011-2019 Middle East Technical University
! Institute of Marine Sciences (IMS-METU), Erdemli/Turkey and
! Istituto Nazionale di Oceanografia e di Geofisica Sperimentale (OGS),
! Trieste/Italy.
!
! This program is free software; you can redistribute it and/or modify
! it under the terms of the GNU General Public License version 2 as
! published by the Free Software Foundation.
!
! This program is distributed in the hope that it will be useful, but
! WITHOUT ANY WARRANTY; without even the implied warranty of
! MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
! General Public License for more details.
!
! You should have received a copy of the GNU General Public License
! along with  this program; if not,
! see <http://www.gnu.org/licenses/gpl-2.0.html>.
!========================================================================

              subroutine readVulnerability_io &
          (vrows, vcols, Vulnerability_fname)

! This subroutine reads vulnerability matrix
! from tab-delimited ascii file.

use statevartypesecosim, only: es_vul

implicit none

! INTENT VARIABLES
integer, INTENT(OUT)             :: vrows ! number of rows of vulnerability data
integer, INTENT(OUT)             :: vcols ! number of columns of vulnerability data
character(len = 250), INTENT(IN) :: Vulnerability_fname

integer              :: iec     ! loop counter
character ( len = 250 ) :: groupname, dummy

! open Ecosim vulnerability matrix file
open (333, file = Vulnerability_fname, form = 'formatted')

! read number of rows and columns in the file
read(333, *) dummy, vrows
read(333, *) dummy, vcols
read(333, *)

! allocate size of Ecosim vulnerability data in variable <es_vul>
allocate(es_vul(vrows, vcols))

! read Ecosim vulnerability data from file
do iec = 1, vrows
    read(333, *, end = 300) groupname, es_vul(iec, :)
end do

300 continue
 close(333)

! allocate and populate fields of foraging arena parameters
 call setForagingArenaParameters (vrows, vcols)

end subroutine readVulnerability_io
